import{A as L,E as S,z as h,d as y,v as g,T as E,o as a,k as l,w as O,r as v,a as D,b,e,am as P,O as x,N as _,B as I,an as j,j as M,c as d,J as k,G as C,H as w}from"./index-ee83e50c.js";import{O as T,_ as A,a as N}from"./OrderProduct.vue_vue_type_script_setup_true_lang-a97f2d2d.js";import{u as R}from"./useSingleModal-7d747bce.js";import{_ as B}from"./BaseModal.vue_vue_type_script_setup_true_lang-a2f9fe03.js";import{f as G}from"./currency-161c01a1.js";import{u as V}from"./write-off-61bfcf08.js";import"./format-559bad6a.js";import"./VInfo.vue_vue_type_script_setup_true_lang-44e2e15e.js";import"./types-e76a6185.js";const F=Object.freeze(Object.defineProperty({__proto__:null,EDeliveryType:L,EOrderStatus:S,ORDER_DELIVERY_TYPES:T,useOrderStore:h},Symbol.toStringTag,{value:"Module"})),Y={class:"center gap-xxs"},z=y({__name:"ModalConfirmation",props:{title:{default:"Are you sure?"},handler:null},emits:["close","confirm","reject"],setup(s,{emit:t}){const n=s,{showError:o}=g(),{isLoading:r,startLoading:c,finishLoading:i}=E();async function m(){try{c(),await n.handler(),u(),t("confirm")}catch(p){o(p.message)}finally{i()}}function f(){u(),t("reject")}function u(){t("close")}return(p,$)=>(a(),l(e(B),{"class-name":"modal-confirmation",title:s.title,onClose:u},{default:O(()=>[v(p.$slots,"default"),D("div",Y,[b(e(P),{class:"modal-confirmation__button-confirm","is-submitting":e(r),txt:"OK",onClick:m},null,8,["is-submitting"]),b(e(x),{class:"modal-confirmation__button-reject",txt:"Cancel","border-left-icon":e(_).outer,"border-right-icon":e(_).top,onClick:f},null,8,["border-left-icon","border-right-icon"])])]),_:3},8,["title"]))}});function W(){const s=h();async function t(n){const o=S.purchased;await I.patchStatus(n,{statusId:o});const r=s.orders[n];r.statusId=o}return{getOrder:t}}function q(s){const{isLoading:t,startLoading:n,finishLoading:o}=E(),{showError:r}=g();async function c(){try{n(),await s()}catch(i){r(i.message)}finally{o()}}return{isLoading:t,wrappedPromise:c}}const H=y({__name:"GetOrder",props:{orderId:null},setup(s){const t=s,{showSuccess:n}=g(),{getOrder:o}=W(),{isLoading:r,wrappedPromise:c}=q(i);async function i(){await o(t.orderId),n("Thanks for your order")}return(m,f)=>(a(),l(e(P),{txt:"GET ORDER","border-left-icon":e(_).inner,"border-right-icon":e(_).inner,"after-bg-color":e(j).greenDark,"is-submitting":e(r),onClick:e(c)},null,8,["border-left-icon","border-right-icon","after-bg-color","is-submitting","onClick"]))}});function J(){const s=h(),{writeOff:t}=V();async function n({id:o,sum:r}){await t(r);const{data:c}=await I.patchIsPrepaid(o),i=s.orders[o];i.isPrepaid=c.isPrepaid}return{payOrder:n}}const K=y({__name:"PayOrder",props:{orderId:null,sum:null},setup(s){const t=s,{showSuccess:n}=g(),{isModal:o,openModal:r,closeModal:c}=R(),i=M(()=>`Do you want to pay ${G(t.sum)} per order?`),{payOrder:m}=J();function f(){return m({id:t.orderId,sum:t.sum})}function u(){n("Order has been paid")}return(p,$)=>(a(),d(C,null,[b(e(x),{txt:"PAY",onClick:e(r)},null,8,["onClick"]),e(o)?(a(),l(e(z),{key:0,title:e(i),handler:f,onConfirm:u,onClose:e(c)},null,8,["title","onClose"])):k("",!0)],64))}}),U={class:"container"},Q={key:0},X={key:1,class:"column gap-m"},ce=y({__name:"DeliveryPage",setup(s){const t=h();return(n,o)=>(a(),d("div",U,[e(t).ordersFiltered.delivery.length?(a(),d("div",X,[(a(!0),d(C,null,w(e(t).ordersFiltered.delivery,r=>(a(),l(e(N),{key:r.createdAt,order:r},{products:O(c=>[(a(!0),d(C,null,w(r.products,i=>(a(),l(e(A),{key:i.id,product:i,color:c.color},null,8,["product","color"]))),128))]),actions:O(()=>[r.isPrepaid?k("",!0):(a(),l(e(K),{key:0,"order-id":r.id,sum:r.discountedTotal},null,8,["order-id","sum"])),r.isPrepaid&&r.statusId===e(F).EOrderStatus.ready?(a(),l(e(H),{key:1,"order-id":r.id},null,8,["order-id"])):k("",!0)]),_:2},1032,["order"]))),128))])):(a(),d("h3",Q,"No orders"))]))}});export{ce as default};
