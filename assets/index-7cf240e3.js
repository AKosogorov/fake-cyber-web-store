import{d as l,o as p,k as f,af as C,ag as I,C as m,a0 as x,a1 as P,u as U,l as F,ab as k,h as H,y as q,v as B,D as _,ad as u,ah as R,ae as T,w as W,a as g,b as i,e as r,c as E}from"./index-ee83e50c.js";import{t as z,a as D,_ as V}from"./vee-validate-yup.esm-29c26862.js";import{_ as Z,a as L}from"./VeeInputPassword.vue_vue_type_script_setup_true_lang-35355925.js";import{_ as N}from"./VeeInput.vue_vue_type_script_setup_true_lang-9c362fc0.js";import{_ as Q,a as O}from"./VeeInputUsername.vue_vue_type_script_setup_true_lang-5abc8ee3.js";import"./VInput.vue_vue_type_script_setup_true_lang-4bdfbe48.js";import"./VRadio.vue_vue_type_script_setup_true_lang-6e27a624.js";const j=l({__name:"VeeInputPasswordConfirm",setup(a){return(s,t)=>(p(),f(N,{label:"Confirm the password",name:"confirm","input-type":"password"}))}});function G(){const a=J(),s=K(),t=M();async function e(c){await Promise.all([a(c),s(c),t(c)])}return{createEntities:e}}function J(){const{setWalletId:a}=C();return s;async function s(t){const{data:e}=await I.create({balance:0,userId:t});await m.patchWalletId(t,{walletId:e.name}),a(e.name)}}function K(){const a=x();return s;async function s(t){const{data:e}=await P.create({userId:t,productIds:a.productIds});await m.patchFavoritesId(t,{favoritesId:e.name}),a.setFavoritesId(e.name),a.resetLS()}}function M(){const a=U();return s;async function s(t){const{data:e}=await F.create({userId:t,products:a.cartProducts,total:a.total,discountedTotal:a.discountedTotal,totalProducts:a.totalProducts,totalQuantity:a.totalQuantity});await m.patchCartId(t,{cartId:e.name}),a.setCartId(e.name),a.resetLS()}}const X=/^[A-Za-z0-9_!#$%&'*+/=?`{|}~^.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/gm,Y={class:"column gap-m w-100"},aa=l({__name:"RegisterForm",setup(a){const s=k(),t=H(),e=q(),{createEntities:c}=G(),{showError:w}=B(),h=z(_({username:u().required().min(3).max(50),gender:_().required(),email:u().required().matches(X,"this field must be a valid email"),password:u().required("please enter your password").min(6),confirm:u().required("please repeat your password").oneOf([R("password")],"your passwords do not match")})),{handleSubmit:S,isSubmitting:y}=D({validationSchema:h}),$=S(async n=>{try{const o={email:n.email,password:n.password},{data:d}=await T.singUp(o);e.setTokens(d);const A={username:n.username,email:n.email,gender:n.gender.value};await b(d.localId,A),await c(d.localId),v()}catch(o){w(o.message)}});async function b(n,o){const d=await m.createById(n,o);e.setUser({...d.data,id:n})}function v(){s.push(t.getPersonalArea())}return(n,o)=>(p(),f(r(V),{"button-submit-txt":"Sign up","is-submitting":r(y),"handler-submit":r($)},{default:W(()=>[g("div",Y,[i(r(Q)),i(r(O)),i(r(Z)),i(r(L)),i(r(j))])]),_:1},8,["is-submitting","handler-submit"]))}}),ta={class:"sign-up-page container"},ea=g("h1",{class:"mb-s"},"Sign Up",-1),ua=l({__name:"SignUpPage",setup(a){return(s,t)=>(p(),E("div",ta,[ea,i(r(aa),{class:"sign-up-page__form shadow-black border-radius"})]))}});export{ua as default};
