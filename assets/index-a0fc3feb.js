import{_ as W,o as n,c as _,a as o,d as m,j as r,an as y,b as d,e,f as L,t as p,L as x,g as E,af as S,G as V,H as R,k as h,V as k,w as $,ao as H,v as T,D as I,ap as M,J as B}from"./index-ee83e50c.js";import{_ as P}from"./WalletBalance.vue_vue_type_script_setup_true_lang-47c9ad0e.js";import{E as b}from"./types-e76a6185.js";import{a as A}from"./format-559bad6a.js";import{f as C}from"./currency-161c01a1.js";import{_ as N}from"./ModalForm.vue_vue_type_script_setup_true_lang-6999b9e3.js";import{t as z,a as D}from"./vee-validate-yup.esm-29c26862.js";import{_ as F}from"./VeeInput.vue_vue_type_script_setup_true_lang-9c362fc0.js";import{u as O}from"./useSingleModal-7d747bce.js";import"./const-a1839806.js";import"./BaseModal.vue_vue_type_script_setup_true_lang-a2f9fe03.js";import"./CyberButtonSubmit.vue_vue_type_script_setup_true_lang-4f4e50ab.js";import"./CyberButton.vue_vue_type_script_setup_true_lang-c83485c6.js";import"./VInput.vue_vue_type_script_setup_true_lang-4bdfbe48.js";const Z={},q={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},U=o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.81818 3H21.1818C22.186 3 23 3.89543 23 5V17C23 18.1046 22.186 19 21.1818 19H11V17H21V10H3V12H1V5C1 3.89543 1.81403 3 2.81818 3ZM21 5V8H3V5H21ZM1 17H5.58579L4.29289 18.2929L5.70711 19.7071L9.41421 16L5.70711 12.2929L4.29289 13.7071L5.58579 15H1V17Z",fill:"currentColor"},null,-1),j=[U];function G(s,t){return n(),_("svg",q,j)}const J=W(Z,[["render",G]]),Y=[{id:1,name:"Refill"},{id:2,name:"Payment"},{id:3,name:"Refund"},{id:4,name:"Withdrawal"}],K={class:"wallet-changelog-card"},Q={class:"wallet-changelog-card__date mb-xxs blue pseudo-minus"},X={class:"wallet-changelog-card__grid row between gap-m"},ee={class:"wallet-changelog-card__operation row gap-s blue"},te={class:"wallet-changelog-card__balance blue"},ae=m({__name:"WalletChangelogCard",props:{item:null},setup(s){const t=s,a=r(()=>A(t.item.date)),l=r(()=>Y[t.item.operationTypeId-1].name),c=r(()=>{switch(t.item.operationTypeId){case b.refill:case b.refund:return!0;default:return!1}}),i=r(()=>c.value?y.green:y.red),f=r(()=>C(t.item.sum)),g=r(()=>`${c.value?"+":"-"}${f.value}`),w=r(()=>C(t.item.balance));return(u,v)=>(n(),_("div",K,[d(e(L)),o("div",Q,p(e(a)),1),o("div",X,[o("div",ee,[o("div",{class:x(["wallet-changelog-card__icon",[e(i),e(c)?"pseudo-plus":"pseudo-minus"]])},null,2),E(" "+p(e(l)),1)]),o("div",{class:x(["wallet-changelog-card__sum",e(i)])},p(e(g)),3),o("div",te,"Balance: "+p(e(w)),1)])]))}}),se={key:0},oe={key:1,class:"column gap-s"},ne=m({__name:"WalletChangelog",setup(s){const t=S(),a=r(()=>t.changelog.slice().reverse());return(l,c)=>e(t).changelog.length?(n(),_("div",oe,[(n(!0),_(V,null,R(e(a),i=>(n(),h(e(ae),{key:i.date,item:i},null,8,["item"]))),128))])):(n(),_("span",se,"No records"))}}),le=m({__name:"ButtonRefillWallet",props:{iconSize:{default:k.sm}},setup(s){return(t,a)=>(n(),h(e(H),{class:"button-remove",txt:"Refill wallet"},{icon:$(()=>[d(e(J),{width:s.iconSize,height:s.iconSize},null,8,["width","height"])]),_:1}))}});function ce(){const s=S();async function t(a){const l=s.balance+a,c={balance:l,date:Date.now(),sum:a,operationTypeId:b.refill};await s.updateAndSync(l,c)}return{refill:t}}const ie=m({__name:"RefillWalletModal",emits:["close"],setup(s,{emit:t}){function a(){t("close")}const{refill:l}=ce(),{showError:c}=T(),i=z(I({sum:M().required().positive().min(1).integer().typeError("sum is a required field")})),{handleSubmit:f,isSubmitting:g}=D({validationSchema:i}),w=f(async u=>{try{await l(u.sum),a()}catch(v){c(v.message)}});return(u,v)=>(n(),h(e(N),{title:"Refill wallet","button-submit-txt":"REFILL","is-submitting":e(g),"handler-submit":e(w),onClose:a},{default:$(()=>[d(e(F),{label:"Sum $",name:"sum","input-type":"number",placeholder:"0"})]),_:1},8,["is-submitting","handler-submit"]))}}),re=m({__name:"RefillWallet",setup(s){const{isModal:t,openModal:a,closeModal:l}=O();return(c,i)=>(n(),_(V,null,[d(e(le),{onClick:e(a)},null,8,["onClick"]),e(t)?(n(),h(e(ie),{key:0,onClose:e(l)},null,8,["onClose"])):B("",!0)],64))}});const _e={class:"wallet-page container"},de=o("h1",{class:"mb-s"},"Wallet",-1),me={class:"wallet-page__grid"},ue={class:"wallet-page__aside"},pe={class:"wallet-page__changelog"},Ee=m({__name:"WalletPage",setup(s){return(t,a)=>(n(),_("div",_e,[de,o("div",me,[o("div",ue,[d(e(P),null,{refill:$(()=>[d(e(re))]),_:1})]),o("div",pe,[d(e(ne))])])]))}});export{Ee as default};
